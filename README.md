# Домашнее задание к занятию «Индексы» Тимахова Наталья

# Задание 1
![1indexperc](https://github.com/timakhova/hw_Indexes/blob/main/1-1indexperc.png)

# Задание 2

![1explain](https://github.com/timakhova/hw_Indexes/blob/main/2-1explain.png)

![2expln](https://github.com/timakhova/hw_Indexes/blob/main/2-2expln.png)

Анализ узких мест:
Использование DISTINCT — может быть узким местом, если требуется исключить дублирующиеся строки, особенно на больших наборах данных.
Оператор DATE() — может приводить к тому, что индекс на payment_date не используется, так как функция DATE() применяется к колонке. Это приводит к полному сканированию таблицы.
JOIN-ы — если не созданы индексы по ключевым полям, используемым в условиях соединения, то это может замедлить выполнение запроса.
SUM() с PARTITION BY — оконные функции могут стать узким местом, если работают с большими наборами данных без индексов.
Оптимизация запроса:

1. Изменение запроса:
Оптимизируем запрос, убирая использование функции DATE() над колонкой, чтобы можно было использовать индексы.

![3optim](https://github.com/timakhova/hw_Indexes/blob/main/2-3optim.png)

Заменив DATE(p.payment_date) = '2005-07-30' на более точное сравнение с временными границами, мы позволяем использовать индексы на колонке payment_date.

2. Добавление индексов:
Для улучшения производительности можно добавить индексы на те колонки, которые используются в соединениях и фильтрах:

![4addindex](https://github.com/timakhova/hw_Indexes/blob/main/2-4addindex.png)

Проверка оптимизации:

![5newexpl](https://github.com/timakhova/hw_Indexes/blob/main/2-5newexpl.png)
![6newexpln2](https://github.com/timakhova/hw_Indexes/blob/main/2-6newexpln2.png)

# Задание 3

В PostgreSQL существует множество различных типов индексов, которые используются для оптимизации запросов. Некоторые из них уникальны для PostgreSQL и не поддерживаются в MySQL.

1. GIN (Generalized Inverted Index)
Использование: GIN индексы оптимальны для работы с массивами, документами JSONB, и другими сложными типами данных. Они эффективно индексируют содержимое коллекций, таких как массивы, и позволяют выполнять поиск по множеству элементов внутри этих коллекций.
Пример: Поиск элементов в массиве или поиск по полям JSON.
MySQL: Подобного индекса в MySQL нет, хотя MySQL поддерживает индексы для JSON в более поздних версиях, но они не такие мощные и гибкие, как GIN в PostgreSQL.
2. GiST (Generalized Search Tree)
Использование: GiST индексы позволяют индексировать данные, которые не обязательно подчиняются строгим линейным порядкам. Это полезно для индексации геометрических данных, диапазонов, полнотекстового поиска и других нетривиальных структур.
Пример: Географические индексы для поиска по расстоянию, полнотекстовый поиск с использованием индексов на колонки tsvector.
MySQL: MySQL не имеет аналога GiST индексов, хотя поддержка пространственных индексов присутствует через типы данных SPATIAL, они более ограничены по функциональности.
3. SP-GiST (Space-Partitioned Generalized Search Tree)
Использование: SP-GiST индексы полезны для данных, которые можно разбить на непересекающиеся подпространства. Это хорошо подходит для индексирования данных, таких как точки на плоскости или временные диапазоны.
Пример: Используется для пространственных индексов, временных диапазонов и поиска по непересекающимся множествам.
MySQL: Подобных индексов в MySQL нет.
4. BRIN (Block Range INdex)
Использование: BRIN индексы эффективны для больших таблиц, которые отсортированы по какому-то критерию. BRIN индексы сохраняют только минимальные и максимальные значения для каждого блока данных, что позволяет значительно сократить размер индекса.
Пример: Подходит для больших таблиц с временными метками, где записи отсортированы по времени.
MySQL: Нет прямого аналога в MySQL, хотя можно использовать механизмы partitioning для больших таблиц.
5. Ревёрсные индексы
Использование: Позволяют индексировать строки в обратном порядке, что полезно для поиска по последним символам строки.
Пример: Можно использовать для поиска по доменам в URL.
MySQL: В MySQL также нет поддержки реверсных индексов.
